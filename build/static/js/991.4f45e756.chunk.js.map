{"version":3,"file":"static/js/991.4f45e756.chunk.js","mappings":"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","sources":["components/Collection/CollectionComponents/CollectionSettings/CollectionSettings.tsx","components/Collection/CollectionComponents/CollectionSettings/index.ts"],"sourcesContent":["import {\r\n    Accordion,\r\n    AccordionDetails,\r\n    AccordionSummary,\r\n    Box,\r\n    Button,\r\n    IconButton,\r\n    Modal, Switch,\r\n    Typography\r\n} from \"@mui/material\";\r\nimport CloseIcon from \"@mui/icons-material/Close\";\r\nimport ExpandMoreIcon from \"@mui/icons-material/ExpandMore\";\r\nimport React, {useCallback, useRef} from \"react\";\r\nimport {IFullCollection} from \"../../../../types/collection\";\r\nimport useSx from \"../../../../hooks/useSx\";\r\nimport collectionStyles from \"../../collectionStyles\";\r\nimport {extendedCollectionsApi} from \"../../../../redux/api/rootApi\";\r\nimport {useNavigate} from \"react-router-dom\";\r\nimport useShortTranslation from \"../../../../hooks/useShortTranslation\";\r\nimport FullScreenLoader from \"../../../Loaders/FullScreenLoader\";\r\n\r\nconst CollectionInfo = React.lazy(() => import( \"./CollectionSettingsComponents/CollectionInfo\"));\r\nconst AddUserToCollection = React.lazy(() => import( \"./CollectionSettingsComponents/AddUserToCollection\"));\r\nconst AuthorsInfo = React.lazy(() => import( \"./CollectionSettingsComponents/AuthorsInfo\"));\r\nconst ViewersInfo = React.lazy(() => import( \"./CollectionSettingsComponents/ViewersInfo\"));\r\n\r\n\r\ninterface ICollectionSettingsProps {\r\n    data: IFullCollection,\r\n    closeSettingsModal: () => void,\r\n    isSettingsOpen: boolean\r\n}\r\n\r\nfunction useHookWithRefCallback({ifNodeFunction}: { ifNodeFunction: (node: HTMLElement) => void }) {\r\n    const ref = useRef<null | HTMLElement>(null)\r\n    const setRef = useCallback((node: null | HTMLElement) => {\r\n\r\n        if (ref.current) {\r\n            // Make sure to cleanup any events/references added to the last instance\r\n        }\r\n\r\n        if (node) {\r\n            ifNodeFunction(node)\r\n        }\r\n\r\n        // Save a reference to the node\r\n        ref.current = node\r\n    }, [])\r\n\r\n    return [setRef]\r\n}\r\n\r\nconst changeBorderRadiusOnResize = (node: HTMLElement) => {\r\n    new ResizeObserver((entries) => {\r\n        const [el] = entries\r\n\r\n        if (Math.ceil(el.contentRect.height) !== Math.ceil(window.innerHeight)) {\r\n            if (node.style.borderRadius === '0px') {\r\n                node.style.borderRadius = '8px'\r\n            }\r\n\r\n            return\r\n        } else {\r\n            node.style.borderRadius = '0px'\r\n        }\r\n\r\n    }).observe(node)\r\n}\r\n\r\nexport default function CollectionSettings({data, closeSettingsModal, isSettingsOpen}: ICollectionSettingsProps) {\r\n\r\n    const {collection, currentUserStatus} = data\r\n    const {_id: collectionId, title, tags, authors, isPrivate, viewers} = collection\r\n    const styles = useSx(collectionStyles)\r\n\r\n    const [modalRef] = useHookWithRefCallback({ifNodeFunction: changeBorderRadiusOnResize})\r\n\r\n    const navigate = useNavigate()\r\n\r\n    const [changeIsPrivate] = extendedCollectionsApi.useChangeIsPrivateMutation()\r\n    const [deleteCurrentUserFromCollection] = extendedCollectionsApi.useDeleteCurrentUserFromCollectionMutation()\r\n    const [deleteCollection] = extendedCollectionsApi.useDeleteCollectionMutation()\r\n\r\n    const [expanded, setExpanded] = React.useState<string | false>(false);\r\n\r\n    const handleChange =\r\n        (panel: string) => (event: React.SyntheticEvent, isExpanded: boolean) => {\r\n            setExpanded(isExpanded ? panel : false);\r\n        };\r\n    const openAddUserAccordion = () => setExpanded('panel1')\r\n\r\n    const {isAuthor, isAdmin} = currentUserStatus\r\n\r\n    const formattedTags = tags.join(' ')\r\n\r\n    const t = useShortTranslation({componentNameKey: \"Collection.CollectionSettings\"})\r\n\r\n    const onLeaveCollection = async () => {\r\n        if (window.confirm(t('isUserWantToLeave'))) {\r\n            await deleteCurrentUserFromCollection({collectionId}).then(() => navigate('/'))\r\n        }\r\n    }\r\n\r\n    const onDeleteCollection = async () => {\r\n        if (isAdmin && window.confirm(t('isUserWantToDeleteCollection'))) {\r\n            await deleteCollection({id: collectionId}).then(() => navigate('/'))\r\n        }\r\n    }\r\n\r\n\r\n    return (\r\n        <Modal\r\n            open={isSettingsOpen}\r\n            onClose={closeSettingsModal}\r\n            sx={styles.backdrop}\r\n        >\r\n            <Box\r\n                sx={styles.modalWrapper}\r\n                ref={modalRef}\r\n            >\r\n                <Box sx={styles.closeIconWrapper}>\r\n                    <Typography variant='body1' sx={styles.title}>{t('title')}</Typography>\r\n\r\n                    <IconButton onClick={closeSettingsModal} sx={styles.closeIcon} color='error'>\r\n                        <CloseIcon/>\r\n                    </IconButton>\r\n                </Box>\r\n                <Box sx={styles.modalContainer}>\r\n                    <CollectionInfo\r\n                        collectionId={collectionId}\r\n                        isAdmin={isAdmin}\r\n                        title={title}\r\n                        tags={formattedTags}\r\n                    />\r\n                    {isAdmin && (\r\n                        <Accordion\r\n                            sx={styles.accordionWrapper}\r\n                            expanded={expanded === 'panel1'}\r\n                            onChange={handleChange('panel1')}\r\n                        >\r\n                            <AccordionSummary\r\n                                expandIcon={<ExpandMoreIcon color='primary'/>}\r\n                                aria-controls=\"panel1bh-content\"\r\n                                id=\"panel1bh-header\"\r\n                            >\r\n                                <Typography sx={styles.accordionTitle}>\r\n                                    {t('addUsersTitle')}\r\n                                </Typography>\r\n                            </AccordionSummary>\r\n                            <AccordionDetails>\r\n                                <AddUserToCollection\r\n                                    collectionId={collectionId}\r\n                                />\r\n                            </AccordionDetails>\r\n                        </Accordion>\r\n                    )}\r\n\r\n                    <Accordion\r\n                        sx={styles.accordionWrapper}\r\n                        expanded={expanded === 'panel2'}\r\n                        onChange={handleChange('panel2')}\r\n                    >\r\n                        <AccordionSummary\r\n                            expandIcon={<ExpandMoreIcon color='primary'/>}\r\n                            aria-controls=\"panel2bh-content\"\r\n                            id=\"panel2bh-header\"\r\n                        >\r\n                            <Typography sx={styles.accordionTitle}>\r\n                                {t('authorsListTitle')}\r\n                            </Typography>\r\n                        </AccordionSummary>\r\n                        <AccordionDetails>\r\n                            <AuthorsInfo\r\n                                isAdmin={isAdmin}\r\n                                authors={authors}\r\n                                collectionId={collectionId}\r\n                                openAddUserAccordion={openAddUserAccordion}\r\n                            />\r\n                        </AccordionDetails>\r\n                    </Accordion>\r\n\r\n                    <Accordion\r\n                        sx={styles.accordionWrapper}\r\n                        expanded={expanded === 'panel3'}\r\n                        onChange={handleChange('panel3')}\r\n                    >\r\n                        <AccordionSummary\r\n                            expandIcon={<ExpandMoreIcon color='primary'/>}\r\n                            aria-controls=\"panel3bh-content\"\r\n                            id=\"panel3bh-header\"\r\n                        >\r\n                            <Typography sx={styles.accordionTitle}>\r\n                                {t('viewersListTitle')}\r\n                            </Typography>\r\n                        </AccordionSummary>\r\n                        <AccordionDetails>\r\n                            <ViewersInfo\r\n                                isAdmin={isAdmin}\r\n                                openAddUserAccordion={openAddUserAccordion}\r\n                                viewers={viewers}\r\n                                collectionId={collectionId}\r\n                            />\r\n                        </AccordionDetails>\r\n                    </Accordion>\r\n                    {isAdmin && (\r\n                        <Box sx={styles.togglePrivateContainer}>\r\n                            <Box>\r\n                                <Typography>{t('privateModeTitle')}</Typography>\r\n                                <Typography variant='caption' sx={{color: 'text.secondary'}}>\r\n                                    {t('privateModeDescription')}\r\n                                </Typography>\r\n                            </Box>\r\n                            <Switch\r\n                                checked={isPrivate}\r\n                                onClick={() => changeIsPrivate({collectionId})}\r\n                            />\r\n                        </Box>\r\n                    )}\r\n                    <Box sx={styles.dangerButtonsWrapper}>\r\n                        {isAdmin &&\r\n                            (<Button\r\n                                    onClick={onDeleteCollection}\r\n                                    color='error'\r\n                                    variant='contained'\r\n                                    sx={{mr: 2}}\r\n                                >\r\n                                    {t('deleteCollectionButton')}\r\n                                </Button>\r\n                            )}\r\n                        <Button\r\n                            onClick={onLeaveCollection}\r\n                            color='error'\r\n                            variant='contained'\r\n                        >\r\n                            {t('leaveCollectionButton')}\r\n                        </Button>\r\n                    </Box>\r\n                </Box>\r\n            </Box>\r\n        </Modal>\r\n    )\r\n}","import CollectionSettings from \"./CollectionSettings\";\r\n\r\nexport default CollectionSettings"],"names":["CollectionInfo","React","AddUserToCollection","AuthorsInfo","ViewersInfo","changeBorderRadiusOnResize","node","ResizeObserver","entries","el","Math","ceil","contentRect","height","window","innerHeight","style","borderRadius","observe","data","closeSettingsModal","isSettingsOpen","collection","currentUserStatus","collectionId","_id","title","tags","authors","isPrivate","viewers","styles","useSx","collectionStyles","ifNodeFunction","ref","useRef","useCallback","current","useHookWithRefCallback","modalRef","navigate","useNavigate","extendedCollectionsApi","changeIsPrivate","deleteCurrentUserFromCollection","deleteCollection","expanded","setExpanded","handleChange","panel","event","isExpanded","openAddUserAccordion","isAdmin","isAuthor","formattedTags","join","t","useShortTranslation","componentNameKey","onLeaveCollection","confirm","then","onDeleteCollection","id","Modal","open","onClose","sx","backdrop","Box","modalWrapper","closeIconWrapper","Typography","variant","IconButton","onClick","closeIcon","color","Close","modalContainer","Accordion","accordionWrapper","onChange","AccordionSummary","expandIcon","ExpandMore","accordionTitle","AccordionDetails","togglePrivateContainer","Switch","checked","dangerButtonsWrapper","Button","mr"],"sourceRoot":""}