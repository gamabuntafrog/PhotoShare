"use strict";(self.webpackChunkphoto_share=self.webpackChunkphoto_share||[]).push([[437],{5437:function(e,r,n){n.r(r),n.d(r,{default:function(){return A}});var t=n(9439),o=n(6015),s=n(4565),i=n(3978),a=n(7205),u=n(7689),c=n(3153),l=n(2791),d=n(2550),f=n(306),p=n(619),m=n(1413),x=n(4165),Z=n(5861),h=n(4871),b=n(9365),v=n(6746),g=n(3898),w=n(9195),j=n(4695),C=n(4343),y=n(9363),k=n(2436),L=n(1608),S=n(3329);function U(e){var r=e.turnOffChangingMode,n=e.setAvatarFile,o=e.setIsUserUpdating,s=(0,c.C)((function(e){return e.userReducer.user})),i=(0,w.cI)({resolver:(0,j.X)(C.Lk),mode:"all"}),u=i.register,d=i.handleSubmit,U=i.watch,I=i.formState.errors,F=I.username,P=I.imageList,A=!(!F&&!P),T=L.Z.useUpdateCurrentUserMutation(),W=(0,t.Z)(T,1)[0],R=function(){var e=(0,Z.Z)((0,x.Z)().mark((function e(r){var n,t,s;return(0,x.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.username,t=r.imageList,o(!0),!t.length){e.next=8;break}return e.next=5,(0,g.Z)(t);case 5:e.t0=e.sent,e.next=9;break;case 8:e.t0="";case 9:return s=e.t0,e.prev=10,e.next=13,W({body:{username:n,avatar:s}}).unwrap();case 13:document.location.reload(),e.next=19;break;case 16:e.prev=16,e.t1=e.catch(10),o(!1);case 19:case"end":return e.stop()}}),e,null,[[10,16]])})));return function(r){return e.apply(this,arguments)}}();(0,l.useEffect)((function(){return(0,y.Z)(U("imageList"),n)}),[U("imageList")]);var M=d((function(e){var r=e.username,n=e.imageList;return R({username:r,imageList:n})})),D=(0,k.Z)({componentNameKey:"UserProfile.ChangeUserProfile"}),O=null!==F&&void 0!==F&&F.message?D(F.message):D("usernameLabel"),B=(0,f.Z)(p.Z).changeUserProfile;return(0,S.jsxs)(h.Z,{sx:B.formWrapper,children:[(0,S.jsxs)(a.Z,{type:"button",sx:{my:1},children:[(0,S.jsx)(b.Z,{sx:B.inputLabel,htmlFor:"avatar",children:D("changeAvatarButtonAsLabel")}),(0,S.jsx)("input",(0,m.Z)((0,m.Z)({},u("imageList")),{},{id:"avatar",type:"file",accept:"image/*",hidden:!0}))]}),(0,S.jsx)(b.Z,{error:!!F,htmlFor:"username",children:O}),(0,S.jsx)(v.Z,(0,m.Z)((0,m.Z)({defaultValue:s.username,error:!!F},u("username")),{},{id:"username",sx:{my:1}})),(0,S.jsx)(a.Z,{type:"button",color:"error",sx:{mb:1},onClick:r,children:D("cancelChangesButton")}),(0,S.jsx)(a.Z,{disabled:A,type:"submit",onClick:M,children:D("saveChangesButton")})]})}var I=n(5444),F=n(4196),P=n(5468);var A=function(){var e=(0,u.UO)().id,r=void 0===e?"":e,n=(0,c.C)((function(e){return e.userReducer.user})),m=L.Z.useGetUserByIdQuery({id:r}),x=m.data,Z=m.isLoading,h=m.error,b=(0,l.useState)(!1),v=(0,t.Z)(b,2),g=v[0],w=v[1],j=(0,l.useState)(null),C=(0,t.Z)(j,2),y=C[0],A=C[1],T=(0,l.useState)(!1),W=(0,t.Z)(T,2),R=W[0],M=W[1],D=(0,d.Z)(r,(null===x||void 0===x?void 0:x.subscribersCount)||0),O=D.isSubscribed,B=D.toggleSubscribe,N=D.subscribersCount,V=(0,f.Z)(p.Z),G=(0,k.Z)({componentNameKey:"UserProfile"});if(Z||g)return(0,S.jsx)(I.Z,{withMeta:!0});if(!x||h||!n)return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(P.Z,{keyOfOther:"error"}),(0,S.jsx)(o.Z,{sx:V.loaderOrErrorWrapper,children:(0,S.jsx)(s.Z,{variant:"h1",children:G("notFound")})})]});var E=x.avatar,H=x.username,_=x.email,K=x.createdAt,X=x._id,z=x.subscribesCount,Q=x.postsCount,q=x.canViewAllowedToViewCollections,J=E||"",Y=new Date(K).toLocaleDateString("en-US").split("/"),$=(0,t.Z)(Y,3),ee=$[0],re=[$[1],ee,$[2]].join("."),ne=n._id===X;return(0,S.jsxs)(o.Z,{children:[(0,S.jsx)(P.Z,{keyOfTitle:"userProfile",options:{username:H}}),(0,S.jsxs)(o.Z,{sx:V.wrapper,children:[(0,S.jsx)(i.Z,{sx:V.avatar,src:y||J}),(0,S.jsxs)(o.Z,{sx:V.userInfoWrapper,children:[R?(0,S.jsx)(U,{setIsUserUpdating:w,turnOffChangingMode:function(){A(null),M(!1)},setAvatarFile:A}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(s.Z,{variant:"h4",children:H}),(0,S.jsx)(s.Z,{variant:"body1",children:_}),(0,S.jsxs)(o.Z,{sx:V.userInfoSecondWrapper,children:[(0,S.jsx)(s.Z,{sx:V.infoItem,children:G("postsCount",{postsCount:Q})}),(0,S.jsxs)(s.Z,{sx:V.infoItem,children:[" ",G("subscribesCount",{subscribesCount:z})]}),(0,S.jsx)(s.Z,{sx:V.infoItem,children:G("subscribersCount",{subscribersCount:N})})]}),(0,S.jsx)(s.Z,{children:G("userCreatedAt",{date:re})})]}),ne&&!R&&(0,S.jsx)(a.Z,{onClick:function(){return M(!0)},children:G("changeProfileButton")}),!ne&&(0,S.jsx)(a.Z,{variant:"outlined",sx:{mt:1},onClick:function(){return B(r,O)},children:G(O?"unsubscribeButton":"subscribeButton")})]})]}),(0,S.jsxs)(o.Z,{sx:V.navLinksWrapper,children:[(0,S.jsx)(F.bP,{className:"first",to:"",end:!0,children:G("linkToPosts")}),(0,S.jsx)(F.bP,{to:"collections",children:G("linkToCollections")}),q&&(0,S.jsx)(F.bP,{to:"allowedToView",children:G("linkToAllowedToView")})]}),(0,S.jsx)(o.Z,{sx:{minHeight:"100vh"},children:(0,S.jsx)(u.j3,{})})]})}},619:function(e,r,n){n.d(r,{C:function(){return i}});var t=n(4942),o=n(277),s=n(1087);r.Z=function(e){return{loaderOrErrorWrapper:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},wrapper:(0,t.Z)({display:"flex",alignItems:"center",justifyContent:"center",my:3},e.breakpoints.down("tablet"),{flexDirection:"column"}),avatar:{width:"200px",height:"200px"},userInfoWrapper:(0,t.Z)({display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",ml:2},e.breakpoints.down("tablet"),{ml:0}),userInfoSecondWrapper:{display:"flex",margin:1},infoItem:{mx:1,textAlign:"center"},allowedToViewCollectionsWrapper:{mt:3,mb:6,pt:3,borderTop:"8px solid ".concat(e.palette.primary.main)},navLinksWrapper:(0,t.Z)({padding:3,display:"flex",justifyContent:"center",alignItems:"center",fontSize:"24px","& > a":{marginLeft:3}},e.breakpoints.down("tablet"),{flexDirection:"column","& > a":{marginTop:1,marginLeft:0,textAlign:"center"}}),changeUserProfile:{formWrapper:(0,t.Z)({ml:1},e.breakpoints.down("tablet"),{ml:0,"& *":{textAlign:"center"}}),inputLabel:{cursor:"pointer",color:"inherit",width:"100%"}}}};var i=(0,o.ZP)(s.OL)((function(e){var r=e.theme;return(0,t.Z)({position:"relative",backgroundColor:r.palette.primary.main,borderRadius:"8px",overflow:"hidden",minHeight:"150px",maxHeight:"300px"},r.breakpoints.down("tablet"),{height:"150px"})}))},2550:function(e,r,n){var t=n(4165),o=n(5861),s=n(9439),i=n(3153),a=n(653),u=n(1608),c=n(2791);r.Z=function(e,r){var n=(0,c.useState)(r),l=(0,s.Z)(n,2),d=l[0],f=l[1];(0,c.useLayoutEffect)((function(){f(r)}),[r]);var p=(0,i.C)((function(e){return e.userReducer.user.subscribes})).some((function(r){return r===e})),m=(0,i.T)(),x=u.Z.useSubscribeToUserMutation(),Z=(0,s.Z)(x,1)[0],h=u.Z.useUnsubscribeFromUserMutation(),b=(0,s.Z)(h,1)[0],v=function(){var e=(0,o.Z)((0,t.Z)().mark((function e(r,n){return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{n?b({id:r}).unwrap():Z({id:r}).unwrap(),m(n?(0,a.Xd)(r):(0,a.oL)(r)),f(n?function(e){return--e}:function(e){return++e})}catch(t){console.log(t)}case 1:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}();return{toggleSubscribe:v,isSubscribed:p,subscribersCount:d}}},3898:function(e,r,n){n.d(r,{Z:function(){return s}});var t=n(4165),o=n(5861);function s(e){return i.apply(this,arguments)}function i(){return(i=(0,o.Z)((0,t.Z)().mark((function e(r){var n;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Promise((function(e,n){var t=new FileReader;t.onload=function(r){var n=r.target.result;n&&e(n)},t.readAsDataURL(r[0])})),e.abrupt("return",n);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},9363:function(e,r,n){function t(e,r){if(!e||e&&e.length<1)return r(null);var n=e[0];!function(){var e=new FileReader;e.onload=function(e){var n=e.target.result;n&&r(n)},e.readAsDataURL(n)}()}n.d(r,{Z:function(){return t}})},4871:function(e,r,n){n.d(r,{Z:function(){return b}});var t=n(3366),o=n(7462),s=n(2791),i=n(8182),a=n(4419),u=n(277),c=n(5513),l=n(5878),d=n(1217);function f(e){return(0,d.Z)("MuiFormGroup",e)}(0,l.Z)("MuiFormGroup",["root","row","error"]);var p=n(529),m=n(40),x=n(3329),Z=["className","row"],h=(0,u.ZP)("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:function(e,r){var n=e.ownerState;return[r.root,n.row&&r.row]}})((function(e){var r=e.ownerState;return(0,o.Z)({display:"flex",flexDirection:"column",flexWrap:"wrap"},r.row&&{flexDirection:"row"})})),b=s.forwardRef((function(e,r){var n=(0,c.Z)({props:e,name:"MuiFormGroup"}),s=n.className,u=n.row,l=void 0!==u&&u,d=(0,t.Z)(n,Z),b=(0,p.Z)(),v=(0,m.Z)({props:n,muiFormControl:b,states:["error"]}),g=(0,o.Z)({},n,{row:l,error:v.error}),w=function(e){var r=e.classes,n={root:["root",e.row&&"row",e.error&&"error"]};return(0,a.Z)(n,f,r)}(g);return(0,x.jsx)(h,(0,o.Z)({className:(0,i.Z)(w.root,s),ownerState:g,ref:r},d))}))}}]);
//# sourceMappingURL=437.f7354cd0.chunk.js.map