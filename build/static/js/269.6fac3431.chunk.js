"use strict";(self.webpackChunkphoto_share=self.webpackChunkphoto_share||[]).push([[269],{7758:function(e,t,n){n.d(t,{Z:function(){return W}});var r=n(1413),i=n(4165),o=n(5861),a=n(9439),c=n(9195),s=n(4695),l=n(6817),u=n(803),d=n(3811),p=n(4565),f=n(9365),m=n(6746),h=n(7205),x=(n(2791),n(7689)),g=n(4343),v=n(5802),b=n(9823),Z=n(306),w=function(e){return{backdrop:{display:"flex",alignItems:"center",justifyContent:"center"},wrapper:{bgcolor:"background.default",mx:2,py:2,px:2,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"50vh",borderRadius:4},title:{color:e.palette.text.standard,textAlign:"center",mx:"auto",my:2,wordBreak:"break-word"},form:{display:"flex",flexDirection:"column",width:"90%"},label:{my:1},submitButton:{alignSelf:"end",mt:2}}},k=n(2436),y=n(5468),j=n(5592),S=n(3329),I=function(e){return"function"===typeof e};var W=function(e){var t=e.closeModal,n=e.isModalOpen,W=e.onCreate,C=e.refetch,L=e.postId,M=v.WU.useCreateCollectionMutation(),B=(0,a.Z)(M,2),P=B[0],N=B[1].isLoading,F=(0,c.cI)({resolver:(0,s.X)(g.LP),mode:"all"}),z=F.register,O=F.reset,R=F.handleSubmit,E=F.formState.errors,T=E.title,D=E.tags,G=(0,x.s0)(),U=R((function(e){var t=e.title,n=e.tags.split(" ");_({title:t,tags:n})})),_=function(){var e=(0,o.Z)((0,i.Z)().mark((function e(n){var r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P({body:n}).unwrap();case 3:r=e.sent,O(),t(),I(W)&&W(n.title,r.data.collection._id,L),I(C)&&(C(),G("/post/create/".concat(r.data.collection._id))),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),$=(0,Z.Z)(w),A=(0,k.Z)({componentNameKey:"CreateCollectionModal"}),H=null!==T&&void 0!==T&&T.message?A(T.message):A("titleLabel"),K=null!==D&&void 0!==D&&D.message?A(D.message):A("tagsLabel");return(0,S.jsxs)(S.Fragment,{children:[n&&(0,S.jsx)(y.Z,{keyOfTitle:"createCollectionModal"}),(0,S.jsx)(l.Z,{open:n,onClose:t,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",sx:$.backdrop,children:(0,S.jsx)(u.Z,{sx:$.wrapper,maxWidth:"tablet",children:N?(0,S.jsx)(j.Z,{withMeta:!0}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(d.Z,{color:"error",sx:{alignSelf:"end"},onClick:t,children:(0,S.jsx)(b.Z,{})}),(0,S.jsx)(p.Z,{variant:"h3",sx:$.title,children:A("title")}),(0,S.jsxs)("form",{style:$.form,onSubmit:U,children:[(0,S.jsx)(f.Z,{htmlFor:"title",error:!!T,sx:$.label,children:H}),(0,S.jsx)(m.Z,(0,r.Z)({fullWidth:!0,id:"title"},z("title"))),(0,S.jsx)(f.Z,{htmlFor:"tags",error:!!D,sx:$.label,children:K}),(0,S.jsx)(m.Z,(0,r.Z)({fullWidth:!0,id:"tags"},z("tags"))),(0,S.jsx)(h.Z,{type:"submit",variant:"outlined",sx:$.submitButton,children:A("submitButton")})]})]})})})]})}},9447:function(e,t,n){n.d(t,{Y:function(){return a}});var r=n(1413),i=n(4942),o=n(277);t.Z=function(e){var t;return{createPostContainer:{pt:6,pb:3},formWrapper:(0,i.Z)({display:"flex",alignItems:"center",justifyContent:"center"},e.breakpoints.down("tablet"),{flexDirection:"column"}),form:{width:"300px"},formInputsWrapper:{flexDirection:"column"},breakableText:{wordBreak:"break-all",whiteSpace:"break-spaces"},formInputLabel:(0,r.Z)({my:1},{wordBreak:"break-all",whiteSpace:"break-spaces"}),uploadButton:{mb:1,mt:3,justifySelf:"center",ml:"auto",width:"50%"},imageWrapper:(t={},(0,i.Z)(t,e.breakpoints.up("tablet"),{ml:3}),(0,i.Z)(t,e.breakpoints.down("tablet"),{width:"100%"}),t),imageButtonInputLabel:{cursor:"pointer",color:"inherit",width:"100%",pointerEvents:"none"},collectionsInfo:{buttonWrapper:{display:"flex",alignItems:"baseline"},openMenuButton:function(e){return{color:e?"red":"primary.main",ml:1}},lastItemWrapper:{bgcolor:"background.paper",px:1,py:1,position:"sticky",bottom:"-1px","&:hover":{bgcolor:"background.paper"}}}}};var a=(0,o.ZP)("img")((function(e){var t,n=e.theme;return t={maxHeight:"70vh",objectFit:"contain"},(0,i.Z)(t,n.breakpoints.up("tablet"),{width:"400px"}),(0,i.Z)(t,n.breakpoints.up("laptop"),{width:"800px"}),(0,i.Z)(t,n.breakpoints.down("tablet"),{width:"100%"}),t}))},3269:function(e,t,n){n.r(t),n.d(t,{default:function(){return ee}});var r=n(1413),i=n(4165),o=n(5861),a=n(9439),c=n(803),s=n(6015),l=n(3433),u=n(4942),d=n(3366),p=n(7462),f=n(2791),m=n(8182),h=n(1184),x=n(8519),g=n(4419),v=n(277),b=n(5513),Z=n(4142);var w=f.createContext(),k=n(5878),y=n(1217);function j(e){return(0,y.Z)("MuiGrid",e)}var S=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12],I=(0,k.Z)("MuiGrid",["root","container","item","zeroMinWidth"].concat((0,l.Z)([0,1,2,3,4,5,6,7,8,9,10].map((function(e){return"spacing-xs-".concat(e)}))),(0,l.Z)(["column-reverse","column","row-reverse","row"].map((function(e){return"direction-xs-".concat(e)}))),(0,l.Z)(["nowrap","wrap-reverse","wrap"].map((function(e){return"wrap-xs-".concat(e)}))),(0,l.Z)(S.map((function(e){return"grid-xs-".concat(e)}))),(0,l.Z)(S.map((function(e){return"grid-sm-".concat(e)}))),(0,l.Z)(S.map((function(e){return"grid-md-".concat(e)}))),(0,l.Z)(S.map((function(e){return"grid-lg-".concat(e)}))),(0,l.Z)(S.map((function(e){return"grid-xl-".concat(e)}))))),W=n(3329),C=["className","columns","columnSpacing","component","container","direction","item","rowSpacing","spacing","wrap","zeroMinWidth"];function L(e){var t=parseFloat(e);return"".concat(t).concat(String(e).replace(String(t),"")||"px")}function M(e){var t=e.breakpoints,n=e.values,r="";Object.keys(n).forEach((function(e){""===r&&0!==n[e]&&(r=e)}));var i=Object.keys(t).sort((function(e,n){return t[e]-t[n]}));return i.slice(0,i.indexOf(r))}var B=(0,v.ZP)("div",{name:"MuiGrid",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState,r=n.container,i=n.direction,o=n.item,a=n.spacing,c=n.wrap,s=n.zeroMinWidth,u=n.breakpoints,d=[];r&&(d=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e||e<=0)return[];if("string"===typeof e&&!Number.isNaN(Number(e))||"number"===typeof e)return[n["spacing-xs-".concat(String(e))]];var r=[];return t.forEach((function(t){var i=e[t];Number(i)>0&&r.push(n["spacing-".concat(t,"-").concat(String(i))])})),r}(a,u,t));var p=[];return u.forEach((function(e){var r=n[e];r&&p.push(t["grid-".concat(e,"-").concat(String(r))])})),[t.root,r&&t.container,o&&t.item,s&&t.zeroMinWidth].concat((0,l.Z)(d),["row"!==i&&t["direction-xs-".concat(String(i))],"wrap"!==c&&t["wrap-xs-".concat(String(c))]],p)}})((function(e){var t=e.ownerState;return(0,p.Z)({boxSizing:"border-box"},t.container&&{display:"flex",flexWrap:"wrap",width:"100%"},t.item&&{margin:0},t.zeroMinWidth&&{minWidth:0},"wrap"!==t.wrap&&{flexWrap:t.wrap})}),(function(e){var t=e.theme,n=e.ownerState,r=(0,h.P$)({values:n.direction,breakpoints:t.breakpoints.values});return(0,h.k9)({theme:t},r,(function(e){var t={flexDirection:e};return 0===e.indexOf("column")&&(t["& > .".concat(I.item)]={maxWidth:"none"}),t}))}),(function(e){var t=e.theme,n=e.ownerState,r=n.container,i=n.rowSpacing,o={};if(r&&0!==i){var a,c=(0,h.P$)({values:i,breakpoints:t.breakpoints.values});"object"===typeof c&&(a=M({breakpoints:t.breakpoints.values,values:c})),o=(0,h.k9)({theme:t},c,(function(e,n){var r,i=t.spacing(e);return"0px"!==i?(0,u.Z)({marginTop:"-".concat(L(i))},"& > .".concat(I.item),{paddingTop:L(i)}):null!=(r=a)&&r.includes(n)?{}:(0,u.Z)({marginTop:0},"& > .".concat(I.item),{paddingTop:0})}))}return o}),(function(e){var t=e.theme,n=e.ownerState,r=n.container,i=n.columnSpacing,o={};if(r&&0!==i){var a,c=(0,h.P$)({values:i,breakpoints:t.breakpoints.values});"object"===typeof c&&(a=M({breakpoints:t.breakpoints.values,values:c})),o=(0,h.k9)({theme:t},c,(function(e,n){var r,i=t.spacing(e);return"0px"!==i?(0,u.Z)({width:"calc(100% + ".concat(L(i),")"),marginLeft:"-".concat(L(i))},"& > .".concat(I.item),{paddingLeft:L(i)}):null!=(r=a)&&r.includes(n)?{}:(0,u.Z)({width:"100%",marginLeft:0},"& > .".concat(I.item),{paddingLeft:0})}))}return o}),(function(e){var t,n=e.theme,r=e.ownerState;return n.breakpoints.keys.reduce((function(e,i){var o={};if(r[i]&&(t=r[i]),!t)return e;if(!0===t)o={flexBasis:0,flexGrow:1,maxWidth:"100%"};else if("auto"===t)o={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"};else{var a=(0,h.P$)({values:r.columns,breakpoints:n.breakpoints.values}),c="object"===typeof a?a[i]:a;if(void 0===c||null===c)return e;var s="".concat(Math.round(t/c*1e8)/1e6,"%"),l={};if(r.container&&r.item&&0!==r.columnSpacing){var u=n.spacing(r.columnSpacing);if("0px"!==u){var d="calc(".concat(s," + ").concat(L(u),")");l={flexBasis:d,maxWidth:d}}}o=(0,p.Z)({flexBasis:s,flexGrow:0,maxWidth:s},l)}return 0===n.breakpoints.values[i]?Object.assign(e,o):e[n.breakpoints.up(i)]=o,e}),{})}));var P=function(e){var t=e.classes,n=e.container,r=e.direction,i=e.item,o=e.spacing,a=e.wrap,c=e.zeroMinWidth,s=e.breakpoints,u=[];n&&(u=function(e,t){if(!e||e<=0)return[];if("string"===typeof e&&!Number.isNaN(Number(e))||"number"===typeof e)return["spacing-xs-".concat(String(e))];var n=[];return t.forEach((function(t){var r=e[t];if(Number(r)>0){var i="spacing-".concat(t,"-").concat(String(r));n.push(i)}})),n}(o,s));var d=[];s.forEach((function(t){var n=e[t];n&&d.push("grid-".concat(t,"-").concat(String(n)))}));var p={root:["root",n&&"container",i&&"item",c&&"zeroMinWidth"].concat((0,l.Z)(u),["row"!==r&&"direction-xs-".concat(String(r)),"wrap"!==a&&"wrap-xs-".concat(String(a))],d)};return(0,g.Z)(p,j,t)},N=f.forwardRef((function(e,t){var n=(0,b.Z)({props:e,name:"MuiGrid"}),r=(0,Z.Z)().breakpoints,i=(0,x.Z)(n),o=i.className,a=i.columns,c=i.columnSpacing,s=i.component,l=void 0===s?"div":s,u=i.container,h=void 0!==u&&u,g=i.direction,v=void 0===g?"row":g,k=i.item,y=void 0!==k&&k,j=i.rowSpacing,S=i.spacing,I=void 0===S?0:S,L=i.wrap,M=void 0===L?"wrap":L,N=i.zeroMinWidth,F=void 0!==N&&N,z=(0,d.Z)(i,C),O=j||I,R=c||I,E=f.useContext(w),T=h?a||12:E,D={},G=(0,p.Z)({},z);r.keys.forEach((function(e){null!=z[e]&&(D[e]=z[e],delete G[e])}));var U=(0,p.Z)({},i,{columns:T,container:h,direction:v,item:y,rowSpacing:O,columnSpacing:R,wrap:M,zeroMinWidth:F,spacing:I},D,{breakpoints:r.keys}),_=P(U);return(0,W.jsx)(w.Provider,{value:T,children:(0,W.jsx)(B,(0,p.Z)({ownerState:U,className:(0,m.Z)(_.root,o),as:l,ref:t},G))})})),F=N,z=n(9365),O=n(3595),R=n(5017),E=n(7205),T=n(6746),D=n(9195),G=n(4695),U=n(7689),_=n(9363),$=n(3898),A=n(7758),H=n(4343),K=n(5802),V=n(5444),X=n(306),Y=n(9447),Q=n(2436),q=n(5468),J=f.lazy((function(){return n.e(342).then(n.bind(n,6342))}));var ee=function(){var e,t=(0,U.UO)().id,n=void 0===t?"":t,l=(0,f.useState)(null),u=(0,a.Z)(l,2),d=u[0],p=u[1],m=(0,f.useState)(!1),h=(0,a.Z)(m,2),x=h[0],g=h[1],v=(0,f.useState)(!1),b=(0,a.Z)(v,2),Z=b[0],w=b[1],k=(0,f.useRef)(null),y=K.WU.useGetCurrentUserCollectionsQuery(),j=y.data,S=void 0===j?[]:j,I=y.isLoading,C=y.refetch,L=K.s4.useCreatePostMutation(),M=(0,a.Z)(L,1)[0],B=(0,U.s0)(),P=function(e){return S.findIndex((function(t){return t._id===e}))},N=(0,D.cI)({resolver:(0,G.X)(H.rv),mode:"all",defaultValues:{title:"",body:"",collectionIdIndex:-1}}),ee=N.register,te=N.watch,ne=N.handleSubmit,re=N.setValue,ie=N.formState.errors,oe=ie.title,ae=ie.body,ce=ie.imageList,se=ie.tags,le=ie.collectionIdIndex,ue=N.clearErrors,de=ee("imageList"),pe=!!(oe||ae||ce||se||le),fe=ne(function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n,r,o,a,c,s,l,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.title,r=t.body,o=t.imageList,a=t.tags,c=t.collectionIdIndex,s=a.split(" ").filter((function(e){return""!==e})),e.next=4,(0,$.Z)(o);case 4:return l=e.sent,u=S[c]._id,e.next=8,me({title:n,body:r,image:l,tags:s,collectionId:u});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),me=function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g(!0),e.prev=1,e.next=4,M({body:t}).unwrap().then((function(){return B("/")}));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),g(!1);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}();(0,f.useEffect)((function(){re("collectionIdIndex",P(n)),P(n)>=0&&ue("collectionIdIndex")}),[n,S.length]);var he=(0,X.Z)(Y.Z),xe=(0,Q.Z)({componentNameKey:"CreatePost"}),ge=(null===(e=S[te("collectionIdIndex")])||void 0===e?void 0:e.title)||xe("selectCollectionButton"),ve=null!==oe&&void 0!==oe&&oe.message?xe(oe.message):xe("titleLabel"),be=null!==ae&&void 0!==ae&&ae.message?xe(ae.message):xe("bodyLabel"),Ze=null!==ce&&void 0!==ce&&ce.message?xe(ce.message):Boolean(d)?xe("selectedImageLabel"):xe("imageLabel"),we=null!==se&&void 0!==se&&se.message?xe(se.message):xe("tagsLabel");return x||I?(0,W.jsx)(V.Z,{withMeta:!0}):(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(q.Z,{keyOfTitle:"createPost",options:{willSavedIn:ge}}),(0,W.jsxs)(c.Z,{sx:he.createPostContainer,children:[(0,W.jsx)(A.Z,{refetch:function(){C()},closeModal:function(){return w(!1)},isModalOpen:Z}),(0,W.jsxs)(s.Z,{sx:he.formWrapper,children:[(0,W.jsx)("form",{style:he.form,onSubmit:fe,children:(0,W.jsxs)(F,{container:!0,sx:he.formInputsWrapper,children:[(0,W.jsx)(F,{item:!0,ml:"auto",children:(0,W.jsx)(J,{selectCollection:function(e){B("/post/create/".concat(e))},collections:S,openModal:function(){return w(!0)},collectionIdError:!!le,willSavedInCollectionTitle:ge})}),(0,W.jsxs)(F,{sx:(0,r.Z)((0,r.Z)({},he.breakableText),{},{my:2}),item:!0,children:[oe&&(0,W.jsx)(z.Z,{htmlFor:"title",error:!!oe,sx:he.formInputLabel,children:ve}),(0,W.jsx)(O.Z,(0,r.Z)({placeholder:xe("titlePlaceholder"),error:!!oe,fullWidth:!0,id:"title"},ee("title")))]}),(0,W.jsxs)(F,{item:!0,children:[(0,W.jsx)(z.Z,{htmlFor:"body",error:!!ae,sx:he.formInputLabel,children:be}),(0,W.jsx)(R.Z,(0,r.Z)({placeholder:xe("bodyPlaceholder"),multiline:!0,maxRows:6,minRows:3,error:!!ae,fullWidth:!0,id:"body"},ee("body")))]}),(0,W.jsx)(F,{item:!0,children:(0,W.jsxs)(E.Z,{type:"button",sx:{my:1},color:ce?"error":"primary",fullWidth:!0,onClick:function(){var e;return null===(e=k.current)||void 0===e?void 0:e.click()},children:[(0,W.jsx)(z.Z,{error:!!ce,sx:he.imageButtonInputLabel,htmlFor:"imageList",ref:k,children:Ze}),(0,W.jsx)("input",(0,r.Z)((0,r.Z)({},de),{},{id:"imageList",type:"file",accept:"image/*",onChange:function(e){de.onChange(e),e.target.files&&(0,_.Z)(e.target.files,p)},hidden:!0}))]})}),(0,W.jsxs)(F,{item:!0,children:[(0,W.jsx)(z.Z,{htmlFor:"tags",error:!!se,sx:he.formInputLabel,children:we}),(0,W.jsx)(T.Z,(0,r.Z)({placeholder:xe("tagsPlaceholder"),error:!!se,fullWidth:!0,id:"tags"},ee("tags")))]}),(0,W.jsx)(E.Z,{variant:"contained",disabled:pe,type:"submit",sx:he.uploadButton,children:xe(pe?"submitButtonDisabled":"submitButton")})]})}),(0,W.jsx)(s.Z,{sx:he.imageWrapper,children:(0,W.jsx)(Y.Y,{src:d||""})})]})]})]})}},5592:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(6015),i=n(6580),o=(n(2791),n(5468)),a=n(3329);function c(e){var t=e.size,n=e.bgOff,c=e.withMeta;return(0,a.jsxs)(a.Fragment,{children:[c&&(0,a.jsx)(o.Z,{keyOfOther:"loading"}),(0,a.jsx)(r.Z,{sx:{bgcolor:n?"none":"background.default",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",mt:7,position:"relative",width:t||"20vw",height:t||"20vh",mx:"auto"},children:(0,a.jsx)(r.Z,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"100%",height:"100%"},children:(0,a.jsx)(i.Z,{size:t||"20vw"})})})]})}},3898:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(4165),i=n(5861);function o(e){return a.apply(this,arguments)}function a(){return(a=(0,i.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Promise((function(e,n){var r=new FileReader;r.onload=function(t){var n=t.target.result;n&&e(n)},r.readAsDataURL(t[0])})),e.abrupt("return",n);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},9363:function(e,t,n){function r(e,t){if(!e||e&&e.length<1)return t(null);var n=e[0];!function(){var e=new FileReader;e.onload=function(e){var n=e.target.result;n&&t(n)},e.readAsDataURL(n)}()}n.d(t,{Z:function(){return r}})}}]);
//# sourceMappingURL=269.6fac3431.chunk.js.map