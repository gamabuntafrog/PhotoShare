"use strict";(self.webpackChunkphoto_share=self.webpackChunkphoto_share||[]).push([[437],{5437:function(e,r,n){n.r(r),n.d(r,{default:function(){return A}});var t=n(9439),o=n(6015),s=n(4565),i=n(3978),a=n(7205),u=n(7689),c=n(3153),l=n(2791),d=n(5802),p=n(2550),f=n(306),m=n(619),x=n(1413),Z=n(4165),h=n(5861),b=n(4871),v=n(9365),g=n(6746),w=n(3898),j=n(9195),y=n(4695),C=n(4343),k=n(9363),L=n(2436),S=n(3329);function U(e){var r=e.turnOffChangingMode,n=e.setAvatarFile,o=e.setIsUserUpdating,s=(0,c.C)((function(e){return e.userReducer.user})),i=(0,j.cI)({resolver:(0,y.X)(C.Lk),mode:"all"}),u=i.register,p=i.handleSubmit,U=i.watch,I=i.formState.errors,F=I.username,P=I.imageList,A=!(!F&&!P),T=d.Yy.useUpdateCurrentUserMutation(),W=(0,t.Z)(T,1)[0],R=function(){var e=(0,h.Z)((0,Z.Z)().mark((function e(r){var n,t,s;return(0,Z.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.username,t=r.imageList,o(!0),!t.length){e.next=8;break}return e.next=5,(0,w.Z)(t);case 5:e.t0=e.sent,e.next=9;break;case 8:e.t0="";case 9:return s=e.t0,e.prev=10,e.next=13,W({body:{username:n,avatar:s}}).unwrap();case 13:document.location.reload(),e.next=19;break;case 16:e.prev=16,e.t1=e.catch(10),o(!1);case 19:case"end":return e.stop()}}),e,null,[[10,16]])})));return function(r){return e.apply(this,arguments)}}();(0,l.useEffect)((function(){return(0,k.Z)(U("imageList"),n)}),[U("imageList")]);var M=p((function(e){var r=e.username,n=e.imageList;return R({username:r,imageList:n})})),D=(0,L.Z)({componentNameKey:"UserProfile.ChangeUserProfile"}),O=null!==F&&void 0!==F&&F.message?D(F.message):D("usernameLabel"),B=(0,f.Z)(m.Z).changeUserProfile;return(0,S.jsxs)(b.Z,{sx:B.formWrapper,children:[(0,S.jsxs)(a.Z,{type:"button",sx:{my:1},children:[(0,S.jsx)(v.Z,{sx:B.inputLabel,htmlFor:"avatar",children:D("changeAvatarButtonAsLabel")}),(0,S.jsx)("input",(0,x.Z)((0,x.Z)({},u("imageList")),{},{id:"avatar",type:"file",accept:"image/*",hidden:!0}))]}),(0,S.jsx)(v.Z,{error:!!F,htmlFor:"username",children:O}),(0,S.jsx)(g.Z,(0,x.Z)((0,x.Z)({defaultValue:s.username,error:!!F},u("username")),{},{id:"username",sx:{my:1}})),(0,S.jsx)(a.Z,{type:"button",color:"error",sx:{mb:1},onClick:r,children:D("cancelChangesButton")}),(0,S.jsx)(a.Z,{disabled:A,type:"submit",onClick:M,children:D("saveChangesButton")})]})}var I=n(5444),F=n(4196),P=n(5468);var A=function(){var e=(0,u.UO)().id,r=void 0===e?"":e,n=(0,c.C)((function(e){return e.userReducer.user})),x=d.Yy.useGetUserByIdQuery({id:r}),Z=x.data,h=x.isLoading,b=x.error,v=(0,l.useState)(!1),g=(0,t.Z)(v,2),w=g[0],j=g[1],y=(0,l.useState)(null),C=(0,t.Z)(y,2),k=C[0],A=C[1],T=(0,l.useState)(!1),W=(0,t.Z)(T,2),R=W[0],M=W[1],D=(0,l.useState)(!1),O=(0,t.Z)(D,2),B=(O[0],O[1],(0,p.Z)(r)),N=B.isSubscribed,V=B.toggleSubscribe,G=(0,f.Z)(m.Z),H=(0,L.Z)({componentNameKey:"UserProfile"});if(h||w)return(0,S.jsx)(I.Z,{withMeta:!0});if(!Z||b||!n)return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(P.Z,{keyOfOther:"error"}),(0,S.jsx)(o.Z,{sx:G.loaderOrErrorWrapper,children:(0,S.jsx)(s.Z,{variant:"h1",children:"Not Found"})})]});var Y=Z.avatar,_=Z.username,E=Z.email,K=Z.createdAt,X=Z._id,z=Z.subscribesCount,Q=Z.subscribersCount,q=Z.postsCount,J=Z.canViewAllowedToViewCollections,$=Y||"",ee=new Date(K).toLocaleDateString("en-US").split("/"),re=(0,t.Z)(ee,3),ne=re[0],te=[re[1],ne,re[2]].join("."),oe=n._id===X;return(0,S.jsxs)(o.Z,{children:[(0,S.jsx)(P.Z,{keyOfTitle:"userProfile",options:{username:_}}),(0,S.jsxs)(o.Z,{sx:G.wrapper,children:[(0,S.jsx)(i.Z,{sx:G.avatar,src:k||$}),(0,S.jsxs)(o.Z,{sx:G.userInfoWrapper,children:[R?(0,S.jsx)(U,{setIsUserUpdating:j,turnOffChangingMode:function(){A(null),M(!1)},setAvatarFile:A}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(s.Z,{variant:"h4",children:_}),(0,S.jsx)(s.Z,{variant:"body1",children:E}),(0,S.jsxs)(o.Z,{sx:G.userInfoSecondWrapper,children:[(0,S.jsx)(s.Z,{sx:G.infoItem,children:H("postsCount",{postsCount:q})}),(0,S.jsxs)(s.Z,{sx:G.infoItem,children:[" ",H("subscribesCount",{subscribesCount:z})]}),(0,S.jsx)(s.Z,{sx:G.infoItem,children:H("subscribersCount",{subscribersCount:Q})})]}),(0,S.jsx)(s.Z,{children:H("userCreatedAt",{date:te})})]}),oe&&!R&&(0,S.jsx)(a.Z,{onClick:function(){return M(!0)},children:H("changeProfileButton")}),!oe&&(0,S.jsx)(a.Z,{variant:"outlined",sx:{mt:1},onClick:function(){return V(r,N)},children:H(N?"unsubscribeButton":"subscribeButton")})]})]}),(0,S.jsxs)(o.Z,{sx:G.navLinksWrapper,children:[(0,S.jsx)(F.bP,{className:"first",to:"",end:!0,children:H("linkToPosts")}),(0,S.jsx)(F.bP,{to:"collections",children:H("linkToCollections")}),J&&(0,S.jsx)(F.bP,{to:"allowedToView",children:H("linkToAllowedToView")})]}),(0,S.jsx)(o.Z,{sx:{minHeight:"100vh"},children:(0,S.jsx)(u.j3,{})})]})}},619:function(e,r,n){n.d(r,{C:function(){return i}});var t=n(4942),o=n(277),s=n(1087);r.Z=function(e){return{loaderOrErrorWrapper:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},wrapper:(0,t.Z)({display:"flex",alignItems:"center",justifyContent:"center",my:3},e.breakpoints.down("tablet"),{flexDirection:"column"}),avatar:{width:"200px",height:"200px"},userInfoWrapper:(0,t.Z)({display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",ml:2},e.breakpoints.down("tablet"),{ml:0}),userInfoSecondWrapper:{display:"flex",margin:1},infoItem:{mx:1,textAlign:"center"},allowedToViewCollectionsWrapper:{mt:3,mb:6,pt:3,borderTop:"8px solid ".concat(e.palette.primary.main)},navLinksWrapper:(0,t.Z)({padding:3,display:"flex",justifyContent:"center",alignItems:"center",fontSize:"24px","& > a":{marginLeft:3}},e.breakpoints.down("tablet"),{flexDirection:"column","& > a":{marginTop:1,marginLeft:0,textAlign:"center"}}),changeUserProfile:{formWrapper:(0,t.Z)({ml:1},e.breakpoints.down("tablet"),{ml:0,"& *":{textAlign:"center"}}),inputLabel:{cursor:"pointer",color:"inherit",width:"100%"}}}};var i=(0,o.ZP)(s.OL)((function(e){var r=e.theme;return(0,t.Z)({position:"relative",backgroundColor:r.palette.primary.main,borderRadius:"8px",overflow:"hidden",minHeight:"150px",maxHeight:"300px"},r.breakpoints.down("tablet"),{height:"150px"})}))},2550:function(e,r,n){var t=n(4165),o=n(5861),s=n(9439),i=n(3153),a=n(5802),u=n(653);r.Z=function(e){var r=(0,i.C)((function(e){return e.userReducer.user.subscribes})).some((function(r){return r===e})),n=(0,i.T)(),c=a.Yy.useSubscribeToUserMutation(),l=(0,s.Z)(c,1)[0],d=a.Yy.useUnsubscribeFromUserMutation(),p=(0,s.Z)(d,1)[0],f=function(){var e=(0,o.Z)((0,t.Z)().mark((function e(r,o){return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{o?p({id:r}).unwrap():l({id:r}).unwrap(),n(o?(0,u.Xd)(r):(0,u.oL)(r))}catch(t){console.log(t)}case 1:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}();return{toggleSubscribe:f,isSubscribed:r}}},3898:function(e,r,n){n.d(r,{Z:function(){return s}});var t=n(4165),o=n(5861);function s(e){return i.apply(this,arguments)}function i(){return(i=(0,o.Z)((0,t.Z)().mark((function e(r){var n;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Promise((function(e,n){var t=new FileReader;t.onload=function(r){var n=r.target.result;n&&e(n)},t.readAsDataURL(r[0])})),e.abrupt("return",n);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},9363:function(e,r,n){function t(e,r){if(!e||e&&e.length<1)return r(null);var n=e[0];!function(){var e=new FileReader;e.onload=function(e){var n=e.target.result;n&&r(n)},e.readAsDataURL(n)}()}n.d(r,{Z:function(){return t}})},4871:function(e,r,n){n.d(r,{Z:function(){return b}});var t=n(3366),o=n(7462),s=n(2791),i=n(8182),a=n(4419),u=n(277),c=n(5513),l=n(5878),d=n(1217);function p(e){return(0,d.Z)("MuiFormGroup",e)}(0,l.Z)("MuiFormGroup",["root","row","error"]);var f=n(529),m=n(40),x=n(3329),Z=["className","row"],h=(0,u.ZP)("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:function(e,r){var n=e.ownerState;return[r.root,n.row&&r.row]}})((function(e){var r=e.ownerState;return(0,o.Z)({display:"flex",flexDirection:"column",flexWrap:"wrap"},r.row&&{flexDirection:"row"})})),b=s.forwardRef((function(e,r){var n=(0,c.Z)({props:e,name:"MuiFormGroup"}),s=n.className,u=n.row,l=void 0!==u&&u,d=(0,t.Z)(n,Z),b=(0,f.Z)(),v=(0,m.Z)({props:n,muiFormControl:b,states:["error"]}),g=(0,o.Z)({},n,{row:l,error:v.error}),w=function(e){var r=e.classes,n={root:["root",e.row&&"row",e.error&&"error"]};return(0,a.Z)(n,p,r)}(g);return(0,x.jsx)(h,(0,o.Z)({className:(0,i.Z)(w.root,s),ownerState:g,ref:r},d))}))}}]);
//# sourceMappingURL=437.2b3459e8.chunk.js.map