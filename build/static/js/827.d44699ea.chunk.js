"use strict";(self.webpackChunkphoto_share=self.webpackChunkphoto_share||[]).push([[827],{7758:function(e,t,n){n.d(t,{Z:function(){return T}});var r=n(1413),o=n(4165),i=n(5861),a=n(9439),l=n(9195),s=n(4695),c=n(6817),u=n(803),d=n(3811),f=n(4565),m=n(9365),p=n(6746),h=n(7205),y=(n(2791),n(7689)),g=n(4343),v=n(9823),x=n(306),b=function(e){return{backdrop:{display:"flex",alignItems:"center",justifyContent:"center"},wrapper:{bgcolor:"background.default",mx:2,py:2,px:2,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"50vh",borderRadius:4},title:{color:e.palette.text.standard,textAlign:"center",mx:"auto",my:2,wordBreak:"break-word"},form:{display:"flex",flexDirection:"column",width:"90%"},label:{my:1},submitButton:{alignSelf:"end",mt:2}}},Z=n(2436),I=n(5468),C=n(5592),w=n(1452),j=n(3329),q=function(e){return"function"===typeof e};var T=function(e){var t=e.closeModal,n=e.isModalOpen,T=e.onCreate,k=e.refetch,E=e.postId,P=w.Z.useCreateCollectionMutation(),R=(0,a.Z)(P,2),L=R[0],O=R[1].isLoading,S=(0,l.cI)({resolver:(0,s.X)(g.LP),mode:"all"}),B=S.register,F=S.reset,W=S.handleSubmit,D=S.formState.errors,A=D.title,M=D.tags,Y=(0,y.s0)(),U=W((function(e){var t=e.title,n=e.tags.split(" ");H({title:t,tags:n})})),H=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(n){var r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L({body:n}).unwrap();case 3:r=e.sent,F(),t(),q(T)&&T(n.title,r.data.collection._id,E),q(k)&&(k(),Y("/post/create/".concat(r.data.collection._id))),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),V=(0,x.Z)(b),J=(0,Z.Z)({componentNameKey:"CreateCollectionModal"}),N=null!==A&&void 0!==A&&A.message?J(A.message):J("titleLabel"),_=null!==M&&void 0!==M&&M.message?J(M.message):J("tagsLabel");return(0,j.jsxs)(j.Fragment,{children:[n&&(0,j.jsx)(I.Z,{keyOfTitle:"createCollectionModal"}),(0,j.jsx)(c.Z,{open:n,onClose:t,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",sx:V.backdrop,children:(0,j.jsx)(u.Z,{sx:V.wrapper,maxWidth:"tablet",children:O?(0,j.jsx)(C.Z,{withMeta:!0}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(d.Z,{color:"error",sx:{alignSelf:"end"},onClick:t,children:(0,j.jsx)(v.Z,{})}),(0,j.jsx)(f.Z,{variant:"h3",sx:V.title,children:J("title")}),(0,j.jsxs)("form",{style:V.form,onSubmit:U,children:[(0,j.jsx)(m.Z,{htmlFor:"title",error:!!A,sx:V.label,children:N}),(0,j.jsx)(p.Z,(0,r.Z)({fullWidth:!0,id:"title"},B("title"))),(0,j.jsx)(m.Z,{htmlFor:"tags",error:!!M,sx:V.label,children:_}),(0,j.jsx)(p.Z,(0,r.Z)({fullWidth:!0,id:"tags"},B("tags"))),(0,j.jsx)(h.Z,{type:"submit",variant:"outlined",sx:V.submitButton,children:J("submitButton")})]})]})})})]})}},9447:function(e,t,n){n.d(t,{Y:function(){return a}});var r=n(1413),o=n(4942),i=n(277);t.Z=function(e){var t;return{createPostContainer:{pt:6,pb:3},formWrapper:(0,o.Z)({display:"flex",alignItems:"center",justifyContent:"center"},e.breakpoints.down("tablet"),{flexDirection:"column"}),form:{width:"300px"},formInputsWrapper:{flexDirection:"column"},breakableText:{wordBreak:"break-all",whiteSpace:"break-spaces"},formInputLabel:(0,r.Z)({my:1},{wordBreak:"break-all",whiteSpace:"break-spaces"}),uploadButton:{mb:1,mt:3,justifySelf:"center",ml:"auto",width:"50%"},imageWrapper:(t={},(0,o.Z)(t,e.breakpoints.up("tablet"),{ml:3}),(0,o.Z)(t,e.breakpoints.down("tablet"),{width:"100%"}),t),imageButtonInputLabel:{cursor:"pointer",color:"inherit",width:"100%",pointerEvents:"none"},collectionsInfo:{buttonWrapper:{display:"flex",alignItems:"baseline"},openMenuButton:function(e){return{color:e?"red":"primary.main",ml:1}},lastItemWrapper:{bgcolor:"background.paper",px:1,py:1,position:"sticky",bottom:"-1px","&:hover":{bgcolor:"background.paper"}}}}};var a=(0,i.ZP)("img")((function(e){var t,n=e.theme;return t={maxHeight:"70vh",objectFit:"contain"},(0,o.Z)(t,n.breakpoints.up("tablet"),{width:"400px"}),(0,o.Z)(t,n.breakpoints.up("laptop"),{width:"800px"}),(0,o.Z)(t,n.breakpoints.down("tablet"),{width:"100%"}),t}))},3827:function(e,t,n){n.r(t),n.d(t,{default:function(){return L}});var r=n(1413),o=n(4165),i=n(5861),a=n(9439),l=n(803),s=n(6015),c=n(5953),u=n(9365),d=n(3595),f=n(5017),m=n(7205),p=n(6746),h=n(9195),y=n(4695),g=n(2791),v=n(7689),x=n(9363),b=n(3898),Z=n(7758),I=n(4343),C=n(5444),w=n(306),j=n(9447),q=n(2436),T=n(5468),k=n(9650),E=n(1452),P=n(3329),R=g.lazy((function(){return n.e(342).then(n.bind(n,6342))}));var L=function(){var e,t=(0,v.UO)().id,n=void 0===t?"":t,L=(0,g.useState)(null),O=(0,a.Z)(L,2),S=O[0],B=O[1],F=(0,g.useState)(!1),W=(0,a.Z)(F,2),D=W[0],A=W[1],M=(0,g.useState)(!1),Y=(0,a.Z)(M,2),U=Y[0],H=Y[1],V=(0,g.useRef)(null),J=E.Z.useGetCurrentUserCollectionsQuery(),N=J.data,_=void 0===N?[]:N,z=J.isLoading,K=J.refetch,X=k.Z.useCreatePostMutation(),G=(0,a.Z)(X,1)[0],Q=(0,v.s0)(),$=function(e){return _.findIndex((function(t){return t._id===e}))},ee=(0,h.cI)({resolver:(0,y.X)(I.rv),mode:"all",defaultValues:{title:"",body:"",collectionIdIndex:-1}}),te=ee.register,ne=ee.watch,re=ee.handleSubmit,oe=ee.setValue,ie=ee.formState.errors,ae=ie.title,le=ie.body,se=ie.imageList,ce=ie.tags,ue=ie.collectionIdIndex,de=ee.clearErrors,fe=te("imageList"),me=!!(ae||le||se||ce||ue),pe=re(function(){var e=(0,i.Z)((0,o.Z)().mark((function e(t){var n,r,i,a,l,s,c,u;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.title,r=t.body,i=t.imageList,a=t.tags,l=t.collectionIdIndex,s=a.split(" ").filter((function(e){return""!==e})),e.next=4,(0,b.Z)(i);case 4:return c=e.sent,u=_[l]._id,e.next=8,he({title:n,body:r,image:c,tags:s,collectionId:u});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),he=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(t){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return A(!0),e.prev=1,e.next=4,G({body:t}).unwrap().then((function(){return Q("/")}));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),A(!1);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}();(0,g.useEffect)((function(){oe("collectionIdIndex",$(n)),$(n)>=0&&de("collectionIdIndex")}),[n,_.length]);var ye=(0,w.Z)(j.Z),ge=(0,q.Z)({componentNameKey:"CreatePost"}),ve=(null===(e=_[ne("collectionIdIndex")])||void 0===e?void 0:e.title)||ge("selectCollectionButton"),xe=null!==ae&&void 0!==ae&&ae.message?ge(ae.message):ge("titleLabel"),be=null!==le&&void 0!==le&&le.message?ge(le.message):ge("bodyLabel"),Ze=null!==se&&void 0!==se&&se.message?ge(se.message):Boolean(S)?ge("selectedImageLabel"):ge("imageLabel"),Ie=null!==ce&&void 0!==ce&&ce.message?ge(ce.message):ge("tagsLabel");return D||z?(0,P.jsx)(C.Z,{withMeta:!0}):(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(T.Z,{keyOfTitle:"createPost",options:{willSavedIn:ve}}),(0,P.jsxs)(l.Z,{sx:ye.createPostContainer,children:[(0,P.jsx)(Z.Z,{refetch:function(){K()},closeModal:function(){return H(!1)},isModalOpen:U}),(0,P.jsxs)(s.Z,{sx:ye.formWrapper,children:[(0,P.jsx)("form",{style:ye.form,onSubmit:pe,children:(0,P.jsxs)(c.ZP,{container:!0,sx:ye.formInputsWrapper,children:[(0,P.jsx)(c.ZP,{item:!0,ml:"auto",children:(0,P.jsx)(R,{selectCollection:function(e){Q("/post/create/".concat(e))},collections:_,openModal:function(){return H(!0)},collectionIdError:!!ue,willSavedInCollectionTitle:ve})}),(0,P.jsxs)(c.ZP,{sx:(0,r.Z)((0,r.Z)({},ye.breakableText),{},{my:2}),item:!0,children:[ae&&(0,P.jsx)(u.Z,{htmlFor:"title",error:!!ae,sx:ye.formInputLabel,children:xe}),(0,P.jsx)(d.Z,(0,r.Z)({placeholder:ge("titlePlaceholder"),error:!!ae,fullWidth:!0,id:"title"},te("title")))]}),(0,P.jsxs)(c.ZP,{item:!0,children:[(0,P.jsx)(u.Z,{htmlFor:"body",error:!!le,sx:ye.formInputLabel,children:be}),(0,P.jsx)(f.Z,(0,r.Z)({placeholder:ge("bodyPlaceholder"),multiline:!0,maxRows:6,minRows:3,error:!!le,fullWidth:!0,id:"body"},te("body")))]}),(0,P.jsx)(c.ZP,{item:!0,children:(0,P.jsxs)(m.Z,{type:"button",sx:{my:1},color:se?"error":"primary",fullWidth:!0,onClick:function(){var e;return null===(e=V.current)||void 0===e?void 0:e.click()},children:[(0,P.jsx)(u.Z,{error:!!se,sx:ye.imageButtonInputLabel,htmlFor:"imageList",ref:V,children:Ze}),(0,P.jsx)("input",(0,r.Z)((0,r.Z)({},fe),{},{id:"imageList",type:"file",accept:"image/*",onChange:function(e){fe.onChange(e),e.target.files&&(0,x.Z)(e.target.files,B)},hidden:!0}))]})}),(0,P.jsxs)(c.ZP,{item:!0,children:[(0,P.jsx)(u.Z,{htmlFor:"tags",error:!!ce,sx:ye.formInputLabel,children:Ie}),(0,P.jsx)(p.Z,(0,r.Z)({placeholder:ge("tagsPlaceholder"),error:!!ce,fullWidth:!0,id:"tags"},te("tags")))]}),(0,P.jsx)(m.Z,{variant:"contained",disabled:me,type:"submit",sx:ye.uploadButton,children:ge(me?"submitButtonDisabled":"submitButton")})]})}),(0,P.jsx)(s.Z,{sx:ye.imageWrapper,children:(0,P.jsx)(j.Y,{src:S||""})})]})]})]})}},5592:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(6015),o=n(6580),i=(n(2791),n(5468)),a=n(3329);function l(e){var t=e.size,n=e.bgOff,l=e.withMeta;return(0,a.jsxs)(a.Fragment,{children:[l&&(0,a.jsx)(i.Z,{keyOfOther:"loading"}),(0,a.jsx)(r.Z,{sx:{bgcolor:n?"none":"background.default",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",mt:7,position:"relative",width:t||"20vw",height:t||"20vh",mx:"auto"},children:(0,a.jsx)(r.Z,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"100%",height:"100%"},children:(0,a.jsx)(o.Z,{size:t||"20vw"})})})]})}},1452:function(e,t,n){var r=n(7469),o=n(7883).l.injectEndpoints({endpoints:function(e){return{getOneWithPostsAndAuthor:e.query({query:function(e){var t=e.id;return{url:"/collections/".concat(t)}},transformResponse:function(e){return e.data},providesTags:["Collection"]}),getCollectionsByUserId:e.query({query:function(e){var t=e.id;return{url:"/users/".concat(t,"/collections")}},transformResponse:function(e){return e.data.collections}}),searchCollections:e.query({query:function(e){return{url:"/collections/search",params:{title:e.title}}},transformResponse:function(e){return e.data.collections}}),getAllowedToViewCollections:e.query({query:function(e){var t=e.id;return{url:"/users/".concat(t,"/allowedToViewCollections")}},transformResponse:function(e){return e.data.allowedToViewCollections}}),getCurrentUserCollections:e.query({query:function(){return{url:"/collections/current"}},transformResponse:function(e){return e.data.collections},providesTags:["Collection"]}),createCollection:e.mutation({query:function(e){return{url:"/collections",method:"POST",body:e.body}},transformErrorResponse:r.Y}),deleteCollection:e.mutation({query:function(e){var t=e.id;return{url:"/collections/".concat(t),method:"DELETE"}},transformErrorResponse:r.Y}),savePostInCollection:e.mutation({query:function(e){var t=e.collectionId,n=e.postId;return{url:"/collections/".concat(t,"/saves/").concat(n),method:"POST"}},transformErrorResponse:r.Y}),deletePostFromCollection:e.mutation({query:function(e){var t=e.collectionId,n=e.postId;return{url:"/collections/".concat(t,"/saves/").concat(n),method:"DELETE"}},transformErrorResponse:r.Y}),addAuthorToCollection:e.mutation({query:function(e){var t=e.collectionId,n=e.authorId,r=e.role;return{url:"/collections/".concat(t,"/authors/").concat(n),method:"POST",params:{role:r}}},invalidatesTags:["Collection"]}),addViewerToCollection:e.mutation({query:function(e){var t=e.collectionId,n=e.viewerId;return{url:"/collections/".concat(t,"/viewers/").concat(n),method:"POST"}},invalidatesTags:["Collection"]}),sendRequestToJoinToCollection:e.mutation({query:function(e){var t=e.collectionId;return{url:"/collections/".concat(t,"/requests"),method:"POST"}},invalidatesTags:["Collection"]}),unsendRequestToJoinFromCollection:e.mutation({query:function(e){var t=e.collectionId;return{url:"/collections/".concat(t,"/requests"),method:"DELETE"}},invalidatesTags:["Collection"]}),changeAuthorRoleInCollection:e.mutation({query:function(e){var t=e.collectionId,n=e.authorId,r=e.role;return{url:"/collections/".concat(t,"/authors/").concat(n,"/roles"),method:"PATCH",params:{role:r}}},invalidatesTags:["Collection"]}),changeCollectionInfo:e.mutation({query:function(e){var t=e.collectionId,n=e.title,r=e.tags;return{url:"/collections/".concat(t),method:"PATCH",body:{title:n,tags:r}}},invalidatesTags:["Collection"]}),deleteAuthorFromCollection:e.mutation({query:function(e){var t=e.collectionId,n=e.authorId;return{url:"/collections/".concat(t,"/authors/").concat(n),method:"DELETE"}},invalidatesTags:["Collection"]}),deleteViewerFromCollection:e.mutation({query:function(e){var t=e.collectionId,n=e.viewerId;return{url:"/collections/".concat(t,"/viewers/").concat(n),method:"DELETE"}},invalidatesTags:["Collection"]}),deleteRequestedUserFromCollection:e.mutation({query:function(e){var t=e.collectionId,n=e.userId;return{url:"/collections/".concat(t,"/requests/").concat(n),method:"DELETE"}},invalidatesTags:["Collection"]}),deleteCurrentUserFromCollection:e.mutation({query:function(e){var t=e.collectionId;return{url:"/collections/".concat(t,"/current"),method:"DELETE"}},invalidatesTags:["Collection"]}),changeIsPrivate:e.mutation({query:function(e){var t=e.collectionId;return{url:"/collections/".concat(t,"/isPrivate"),method:"PATCH"}},invalidatesTags:["Collection"]})}}});t.Z=o},9650:function(e,t,n){var r=n(7469),o=n(7883).l.injectEndpoints({endpoints:function(e){return{getMany:e.query({query:function(e){var t=e.page,n=e.arrayOfId;return{url:"/posts",params:{page:t,arrayOfId:JSON.stringify(n)}}},transformResponse:function(e){return e.data.posts}}),getPostsByCollectionId:e.query({query:function(e){var t=e.arrayOfId,n=e.id;return{url:"/posts/collections/".concat(n),params:{arrayOfId:JSON.stringify(t)}}},transformResponse:function(e){return e.data.posts}}),searchPosts:e.query({query:function(e){var t=e.title,n=e.page,r=e.arrayOfId;return{url:"/posts/search",params:{title:t,page:n,arrayOfId:JSON.stringify(r)}}},transformResponse:function(e){return e.data.posts}}),getPostsByUserId:e.query({query:function(e){var t=e.id,n=e.arrayOfId;return{url:"/users/".concat(t,"/posts"),params:{arrayOfId:JSON.stringify(n)}}},transformResponse:function(e){return e.data.posts}}),getOneById:e.query({query:function(e){var t=e.id;return{url:"/posts/".concat(t)}},transformErrorResponse:r.Y,transformResponse:function(e){return e.data.post}}),createPost:e.mutation({query:function(e){return{url:"/posts",method:"POST",body:e.body}},transformErrorResponse:r.Y}),deletePost:e.mutation({query:function(e){var t=e.id;return{url:"/posts/".concat(t),method:"DELETE"}},transformErrorResponse:r.Y}),likeOneById:e.mutation({query:function(e){var t=e.id;return{url:"/posts/".concat(t,"/like"),method:"PATCH"}},transformErrorResponse:r.Y}),unlikeOneById:e.mutation({query:function(e){var t=e.id;return{url:"/posts/".concat(t,"/unlike"),method:"PATCH"}},transformErrorResponse:r.Y})}},overrideExisting:!1});t.Z=o},7469:function(e,t,n){n.d(t,{Y:function(){return r}});var r=function(e){return e.data}},3898:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(4165),o=n(5861);function i(e){return a.apply(this,arguments)}function a(){return(a=(0,o.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Promise((function(e,n){var r=new FileReader;r.onload=function(t){var n=t.target.result;n&&e(n)},r.readAsDataURL(t[0])})),e.abrupt("return",n);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},9363:function(e,t,n){function r(e,t){if(!e||e&&e.length<1)return t(null);var n=e[0];!function(){var e=new FileReader;e.onload=function(e){var n=e.target.result;n&&t(n)},e.readAsDataURL(n)}()}n.d(t,{Z:function(){return r}})}}]);
//# sourceMappingURL=827.d44699ea.chunk.js.map