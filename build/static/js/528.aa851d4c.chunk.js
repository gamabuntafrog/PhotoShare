"use strict";(self.webpackChunkphoto_share=self.webpackChunkphoto_share||[]).push([[528],{7758:function(t,e,n){n.d(e,{Z:function(){return S}});var o=n(1413),r=n(4165),a=n(5861),s=n(9439),i=n(9195),l=n(4695),c=n(6817),u=n(803),p=n(3811),d=n(4565),x=n(9365),h=n(6746),f=n(7205),m=(n(2791),n(7689)),v=n(4343),Z=n(5802),g=n(9823),b=n(306),k=function(t){return{backdrop:{display:"flex",alignItems:"center",justifyContent:"center"},wrapper:{bgcolor:"background.default",mx:2,py:2,px:2,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"50vh",borderRadius:4},title:{color:t.palette.text.standard,textAlign:"center",mx:"auto",my:2,wordBreak:"break-word"},form:{display:"flex",flexDirection:"column",width:"90%"},label:{my:1},submitButton:{alignSelf:"end",mt:2}}},j=n(2436),I=n(5468),w=n(5592),y=n(3329),C=function(t){return"function"===typeof t};var S=function(t){var e=t.closeModal,n=t.isModalOpen,S=t.onCreate,B=t.refetch,L=t.postId,M=Z.WU.useCreateCollectionMutation(),W=(0,s.Z)(M,2),A=W[0],O=W[1].isLoading,P=(0,i.cI)({resolver:(0,l.X)(v.LP),mode:"all"}),T=P.register,_=P.reset,F=P.handleSubmit,N=P.formState.errors,U=N.title,E=N.tags,R=(0,m.s0)(),z=F((function(t){var e=t.title,n=t.tags.split(" ");D({title:e,tags:n})})),D=function(){var t=(0,a.Z)((0,r.Z)().mark((function t(n){var o;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,A({body:n}).unwrap();case 3:o=t.sent,_(),e(),C(S)&&S(n.title,o.data.collection._id,L),C(B)&&(B(),R("/post/create/".concat(o.data.collection._id))),t.next=12;break;case 10:t.prev=10,t.t0=t.catch(0);case 12:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}(),H=(0,b.Z)(k),K=(0,j.Z)({componentNameKey:"CreateCollectionModal"}),X=null!==U&&void 0!==U&&U.message?K(U.message):K("titleLabel"),Y=null!==E&&void 0!==E&&E.message?K(E.message):K("tagsLabel");return(0,y.jsxs)(y.Fragment,{children:[n&&(0,y.jsx)(I.Z,{keyOfTitle:"createCollectionModal"}),(0,y.jsx)(c.Z,{open:n,onClose:e,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",sx:H.backdrop,children:(0,y.jsx)(u.Z,{sx:H.wrapper,maxWidth:"tablet",children:O?(0,y.jsx)(w.Z,{withMeta:!0}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(p.Z,{color:"error",sx:{alignSelf:"end"},onClick:e,children:(0,y.jsx)(g.Z,{})}),(0,y.jsx)(d.Z,{variant:"h3",sx:H.title,children:K("title")}),(0,y.jsxs)("form",{style:H.form,onSubmit:z,children:[(0,y.jsx)(x.Z,{htmlFor:"title",error:!!U,sx:H.label,children:X}),(0,y.jsx)(h.Z,(0,o.Z)({fullWidth:!0,id:"title"},T("title"))),(0,y.jsx)(x.Z,{htmlFor:"tags",error:!!E,sx:H.label,children:Y}),(0,y.jsx)(h.Z,(0,o.Z)({fullWidth:!0,id:"tags"},T("tags"))),(0,y.jsx)(f.Z,{type:"submit",variant:"outlined",sx:H.submitButton,children:K("submitButton")})]})]})})})]})}},5592:function(t,e,n){n.d(e,{Z:function(){return i}});var o=n(6015),r=n(6580),a=(n(2791),n(5468)),s=n(3329);function i(t){var e=t.size,n=t.bgOff,i=t.withMeta;return(0,s.jsxs)(s.Fragment,{children:[i&&(0,s.jsx)(a.Z,{keyOfOther:"loading"}),(0,s.jsx)(o.Z,{sx:{bgcolor:n?"none":"background.default",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",mt:7,position:"relative",width:e||"20vw",height:e||"20vh",mx:"auto"},children:(0,s.jsx)(o.Z,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"100%",height:"100%"},children:(0,s.jsx)(r.Z,{size:e||"20vw"})})})]})}},3084:function(t,e,n){n.d(e,{Z:function(){return w}});var o=n(9439),r=n(7083),a=n(6015),s=n(5226),i=n(1087),l=n(2791),c=n(8882),u=n(7758),p=n(306),d=n(4942),x=n(277),h=function(t){return{postItem:{display:"inline-block","&:hover .buttonsBar":{opacity:1},width:"100%"},postItemWrapper:{position:"relative","&:hover .postImage":{filter:"brightness(80%)"}},image:{width:"100%",borderRadius:"8px",backgroundColor:t.palette.primary.main},postTopButtonsWrapper:(0,d.Z)({display:"flex",alignItems:"center",padding:.5,position:"absolute",top:"0",right:"0",zIndex:100,opacity:0},t.breakpoints.down("laptop"),{opacity:100}),postBottomButtonsWrapper:(0,d.Z)({display:"flex",alignItems:"center",padding:.5,position:"absolute",top:"100%",transform:"translateY(-110%)",zIndex:100,opacity:0,color:t.palette.text.light},t.breakpoints.down("laptop"),{opacity:100}),postItemTitleWrapper:(0,d.Z)({px:.5,pb:1,whiteSpace:"break-spaces",wordBreak:"break-all"},t.breakpoints.down("tablet"),{pl:.5,pr:0,pb:0}),authorAvatar:(0,d.Z)({width:"40px",height:"40px"},t.breakpoints.down("tablet"),{width:32,height:32}),authorUsername:{ml:1}}},f=(0,x.ZP)(i.OL)((function(t){return{display:"flex",alignItems:"center",justifyContent:"start","&:hover p":{color:t.theme.palette.primary.main}}})),m=n(3811),v=n(4565),Z=n(7237),g=n(7488),b=n(3329);function k(t){var e=t.onToggleLike,n=t.isLiked,o=t.likesCount,r=(0,p.Z)(h);return(0,b.jsxs)(a.Z,{sx:r.postBottomButtonsWrapper,className:"buttonsBar",children:[(0,b.jsx)(m.Z,{sx:{color:"currentColor"},onClick:e,children:n?(0,b.jsx)(Z.Z,{color:"secondary"}):(0,b.jsx)(g.Z,{})}),(0,b.jsx)(v.Z,{sx:{ml:.5,color:"currentColor"},children:o})]})}var j=n(3978);function I(t){var e=t.postId,n=t.title,o=t.formattedTags,r=t.authorId,s=t.avatarURL,l=t.username,c=t.showAuthor,u=(0,p.Z)(h);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(a.Z,{sx:u.postItemTitleWrapper,children:(0,b.jsxs)(i.OL,{to:"/posts/".concat(e),children:[(0,b.jsx)(v.Z,{sx:{mb:"-4px"},variant:"h6",children:n}),(0,b.jsx)(v.Z,{variant:"caption",children:o})]})}),c&&(0,b.jsxs)(f,{to:"/users/".concat(r),children:[(0,b.jsx)(j.Z,{sx:u.authorAvatar,src:s||""}),(0,b.jsx)(v.Z,{className:"username",sx:u.authorUsername,children:l})]})]})}var w=function(t){var e=t.post,n=t.postsActions,d=t.showAuthor,x=void 0===d||d,f=(0,l.useState)(!1),m=(0,o.Z)(f,2),v=m[0],Z=m[1],g=n.toggleLike,j=n.toggleSave,w=n.updateSavesInfo,y=e._id,C=e.author,S=e.title,B=e.tags,L=e.likesCount,M=e.image,W=e.isLiked,A=e.isSomewhereSaved,O=e.savesInfo,P=C.username,T=C._id,_=C.avatar,F=void 0===_?"":_,N=B.join(" "),U=(0,p.Z)(h);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(u.Z,{onCreate:w,postId:e._id,closeModal:function(){return Z(!1)},isModalOpen:v}),(0,b.jsxs)(r.Z,{sx:U.postItem,children:[(0,b.jsxs)(a.Z,{sx:U.postItemWrapper,children:[(0,b.jsx)(i.OL,{to:"/posts/".concat(y),children:(0,b.jsx)("img",{src:M,style:U.image,className:"postImage"})}),(0,b.jsx)(a.Z,{sx:U.postTopButtonsWrapper,className:"buttonsBar",children:(0,b.jsx)(c.Z,{collections:O,toggleSave:j,postId:y,isSaved:A,openModal:function(){return Z(!0)}})}),(0,b.jsx)(k,{onToggleLike:function(){return g(y,W)},isLiked:W,likesCount:L})]}),(0,b.jsx)(s.Z,{position:"below",sx:{"& .MuiImageListItemBar-titleWrap":{padding:0}},title:(0,b.jsx)(I,{showAuthor:x,postId:y,title:S,formattedTags:N,authorId:T,avatarURL:F,username:P})})]},y)]})}},8882:function(t,e,n){n.d(e,{Z:function(){return m}});var o=n(5051),r=n(6015),a=n(3811),s=n(2352),i=n(5348),l=n(4346),c=n(7205),u=n(694),p=n(91),d=(n(2791),n(306)),x=function(t){return{wrapper:{ml:"auto"},openMenuButton:{ml:"auto",color:t.palette.text.light},menuList:{backgroundColor:"rgba(0, 0, 0, 0.2)","& .MuiPaper-root":{bgcolor:"background.paper",maxHeight:"300px"},"& .MuiMenu-list":{bgcolor:"background.paper",py:0}},menuItem:{"&:hover .saveActionButton":{display:"flex"},bgcolor:"background.paper",position:"relative"},menuItemButton:{position:"absolute",right:8,display:"none"},staticButtonsWrapper:{bgcolor:"background.paper",px:1,py:1,position:"sticky",bottom:"-1px","&:hover":{bgcolor:"background.paper"}}}},h=n(2436),f=n(3329);var m=function(t){var e=t.collections,n=t.toggleSave,m=t.postId,v=t.isSaved,Z=t.openModal,g=(0,o.Z)(),b=g.anchorEl,k=g.isAnchorEl,j=g.handleClick,I=g.handleClose,w=(0,h.Z)({componentNameKey:"PostSavesInfo"}),y=(0,d.Z)(x);return(0,f.jsxs)(r.Z,{sx:y.wrapper,children:[(0,f.jsx)(a.Z,{id:"basic-button","aria-controls":k?"basic-menu":void 0,"aria-haspopup":"true","aria-expanded":k?"true":void 0,onClick:j,sx:y.openMenuButton,children:v?(0,f.jsx)(u.Z,{}):(0,f.jsx)(p.Z,{})}),(0,f.jsxs)(s.Z,{id:"basic-menu",anchorEl:b,open:k,onClose:I,MenuListProps:{"aria-labelledby":"basic-button"},sx:y.menuList,children:[e.map((function(t){var e=t.title,o=t.isSaved,r=t.collectionId,a=w(o?"deletePostButton":"savePostButton");return(0,f.jsxs)(i.Z,{sx:y.menuItem,onClick:function(){return function(t,e,o){I(),n(t,e,o)}(m,r,o)},children:[(0,f.jsx)(l.Z,{sx:{mr:1},children:e}),(0,f.jsx)(c.Z,{className:"saveActionButton",color:o?"error":"success",sx:y.menuItemButton,variant:"contained",children:a})]},r)})),(0,f.jsx)(r.Z,{sx:y.staticButtonsWrapper,children:(0,f.jsx)(c.Z,{variant:"contained",onClick:function(){I(),Z()},children:w("createNewCollectionButton")})})]})]})}},5051:function(t,e,n){n.d(e,{Z:function(){return a}});var o=n(9439),r=n(2791);function a(){var t=(0,r.useState)(null),e=(0,o.Z)(t,2),n=e[0],a=e[1];return{anchorEl:n,setAnchorEl:a,isAnchorEl:Boolean(n),handleClick:function(t){a(t.currentTarget)},handleClose:function(){a(null)}}}},7898:function(t,e,n){var o=n(3433),r=n(4165),a=n(1413),s=n(5861),i=n(9439),l=n(5802),c=n(2791);e.Z=function(t){var e=t.initPosts,n=l.s4.useUnlikeOneByIdMutation(),u=(0,i.Z)(n,1)[0],p=l.s4.useLikeOneByIdMutation(),d=(0,i.Z)(p,1)[0],x=l.WU.useDeletePostFromCollectionMutation(),h=(0,i.Z)(x,1)[0],f=l.WU.useSavePostInCollectionMutation(),m=(0,i.Z)(f,1)[0],v=(0,c.useState)(e||[]),Z=(0,i.Z)(v,2),g=Z[0],b=Z[1];(0,c.useEffect)((function(){e&&b(e)}),[e]);var k=function(){var t=(0,s.Z)((0,r.Z)().mark((function t(e,n){return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!n){t.next=6;break}return t.next=4,u({id:e}).unwrap();case 4:t.next=8;break;case 6:return t.next=8,d({id:e}).unwrap();case 8:b((function(t){return t.map((function(t){if(t._id===e){var n=t.likesCount,o=t.isLiked,r=o?--n:++n;return(0,a.Z)((0,a.Z)({},t),{},{isLiked:!o,likesCount:r})}return t}))})),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.log(t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e,n){return t.apply(this,arguments)}}(),j=function(){var t=(0,s.Z)((0,r.Z)().mark((function t(e,n,o){return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!o){t.next=6;break}return t.next=4,h({postId:e,collectionId:n}).unwrap();case 4:t.next=8;break;case 6:return t.next=8,m({postId:e,collectionId:n}).unwrap();case 8:b((function(t){return t.map((function(t){if(t._id===e){var r=t.savesCount,s=t.savesInfo.map((function(t){return t.collectionId===n?{isSaved:!o,collectionId:t.collectionId,title:t.title}:t})),i=s.some((function(t){return!!t.isSaved}));return(0,a.Z)((0,a.Z)({},t),{},{isSomewhereSaved:i,savesCount:r,savesInfo:s})}return t}))})),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.log(t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e,n,o){return t.apply(this,arguments)}}(),I=function(){var t=(0,s.Z)((0,r.Z)().mark((function t(e,n,s){return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m({postId:s,collectionId:n}).unwrap();case 3:b((function(t){return t.map((function(t){return t._id===s?(0,a.Z)((0,a.Z)({},t),{},{isSomewhereSaved:!0,savesInfo:[].concat((0,o.Z)(t.savesInfo),[{title:e,collectionId:n,isSaved:!0}])}):(0,a.Z)((0,a.Z)({},t),{},{savesInfo:[].concat((0,o.Z)(t.savesInfo),[{title:e,collectionId:n,isSaved:!1}])})}))})),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.log(t.t0);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e,n,o){return t.apply(this,arguments)}}();return[g,{toggleLike:k,toggleSave:j,updateSavesInfo:I}]}}}]);
//# sourceMappingURL=528.aa851d4c.chunk.js.map